# 인코딩, 유니코드



## 문자 집합

문자를 표현하기 위해서는 문자 집합을 정의해야 한다.

문자 집합은 표현해야 할 문자를 정하고 순서를 지정한 것이다.

한글을 예로 들면 '가' 에서 '힣' 까지 표현해야 할 문자를 순서 별로 지정해야 하고, 인쇄를 위한 제어 문자도 이에 포함이 되어 있어야 한다.



컴퓨터에서 한글을 표현하는 방법은 조합형, 완성형이 있다.

조합형은 초성, 중성, 종성에 각각 코드를 할당하는 것이고 완성형은 '가', '힣' 처럼 완성된 문자에 코드를 할당하는 방식이다.

이 중 완성형이 한글 표준안으로 채택이 되었고, 유니코드 한글 표현 방식도 완성형이 먼저 채택되었다.



## 한글의 문자 집합

한글의 문자 집합은 'N바이트 조합형', '3바이트 조합형', '7비트 완성형', '2바이트 조합형', '2바이트 완성형' 으로 나누어진다.



### N바이트 조합형

유럽어만 표시할 수 있는 컴퓨터에서 한글을 표시하기 위해 고안된 최초의 한글 표현 방식이다.

개별 한글 자음, 모음을 영문자 하나하나에 대응 시키고, 시작과 끝에 Shift In, Shift Out 을 추가하여 구분한 방식이다.

한글은 **^N^bDAzI^O**로 표현할 수 있다.



### 3바이트 조합형

초성, 중성, 종성에 1바이트씩 할당하여 사용하는 방식이다.

중성, 초성이 없는 글자를 위해 fill code 를 정의한다.

N바이트 조합형이 한글을 2바이트에서부터 5바이트로 표현하는데, 3바이트 조합형은 3바이트로 표현한다.

이는 KS X 10001 표준안의 한글 채움 문자 방식과 유사하다.



### 7비트 완성형

처음 1바이트가 소문자이거나 특수 문자이고, 그 다음 1바이트가 대문자이면 한글로 표현한다.

 

### 2바이트 조합형

초성 중성, 종성에 각각 5비트씩 할당하고, 처음 1비트는 1로 설정하여 한글임을 표시한다.

예를 들어 '한글'은 1 10100(ㅎ) 00011(ㅏ) 00101(ㄴ) 1 00010(ㄱ) 11011(ㅡ) 01001(ㄹ) (0xD0, 0x65, 0x8B, 0x69)로 표현된다.



### 2바이트 완성형

완성된 음절을 코드와 일대일 대응시키는 방식이다. 예를 들어, '가'는 0xB0A1, '각'은 0xB0A2로 코드화한다. 

ISO 2022 를 표준을 기준으로 하였으며, 이는 KS C 5601:1987 표준안으로 채택되었다.

ISO 2022 가 ASCII 영역과 겹치지 않도록 첫 번째 비트를 1로 규정하여서 KS C 5601은 0xA1A1 부터 0xFEFE 까지 영역을 사용하였다. (약 8836글자)

더군다나 8836 글자 중 부호 및 일본, 러시아 글자에 1598자, 한자에 4888자를 할당하여 한글에는 2350자 밖에 사용할 수 없었다.

이는 1990년 '똠방각하' 를 표현하지 못하며 문제가 대두되었는데, 완성형으로는 똠을 표현할 수 없었던 것이다.



이 문제를 해결하고자 KS C 5601 표준안에 완성형/조합형을 모두 표준으로 지정하였으나, 표준 조합형은 기존 상용 조합형과 코드가 맞지 않아 거의 사용되지 않았다.

1990년 초반까지 모두 사용되었지만, 국가 주도 프로그램에서 완성형을 기본으로 지원하였고,

Windows 95 에 확장 완성형이 사용되며 조합형은 사장되었다.

현재는 KS C 5601 이 KS X 1001 로, KS 5636 은 KS X 1003 으로 변경되었다.



### 확장 완성형

Microsoft 가 독자적으로 제정한 문자 집합으로 완성형 코드에서 표현할 수 없던 8822자가 추가되었다.

현대 한글을 모두 표현할 수 있다. 그러나 완성형의 2350자는 자음, 모음 순서대로 배열되어 정렬에 문제가 없었지만, 확장 완성형은 문제가 있었다.





## 한글의 인코딩 방식

EUC-KR 은 KS X 1001, KS X 1003 표준안의 인코딩 방식이며, CP949 는 확장 완성형의 인코딩 방식이다.

그러므로 EUC-KR 은 2350자의 한글, CP949 는 11172 자의 한글을 표현할 수 있다.







## 유니코드

한글 뿐 아니라 일본어, 중국어에도 해당 언어를 표현할 수 있는 독자적인 문자 집합이 있다. (EUC-CN, EUC-JP, ...)

문제는 어떻게 동시에 한, 중, 일어를 표현하느냐 이다.

하나의 문자 집합을 사용하는 문서에는 이를 동시에 표현할 수 없다.



이런 문제는 유럽어의 문자 집합에도 있었다. 유로화를 나타내는 '€' 기호에는 ISO 8859-15(Latin 9)의 코드 값 중 0xA4이 할당되었으나 ISO 8859-1(Latin 1)의 0xA4 코드에 할당된 문자는 '¤'다.



이를 위해 전 세계에서 사용되는 모든 문자 집합을 하나로 모아 탄생시킨 것이 유니코드이다.

ISO 10646 표준에서 Universal Character Set 을 정의하고 있으며, 유니코드 1.0.0은 1991년 8월에 제정되었고 5년 후 유니코드 2.0.0에 한글 11172자가 모두 포함되었다.



유니코드 값을 나타내기 위해선 code point 를 사용하는데, 보통 U+를 붙여 표시한다.

예를 들어, 'A' 의 유니코드 값은 U+0041(\u0041) 로 표기한다.

유니코드는 공식적으로 31bit 문자 집합이지만 현재까지는 21비트 이내로 모두 표현가능하다.



### 유니코드 인코딩 방식

유니코드 인코딩 방식은 코드 포인트를 코드화한 UCS-2, UCS-4 와 변환 인코딩 형식 (UTF, UCS Transformation Format) 인 UTF-7, UTF-8, UTF-16, UTF-32 인코딩 등이 있다.

이 중 ASCII 와 호환 가능하며 유니코드 표현이 가능한 UTF-8 인코딩이 가장 많이 사용된다.





 unicode => ASCII

### 예시

- [Unicode 간](https://ko.wikipedia.org/wiki/%EC%9C%A0%EB%8B%88%EC%BD%94%EB%93%9C_A000~AFFF) => U+AC04 (\uAC04)

- 2진수 => 1010 1100 0000 0100
- UTF-8 => **1110 **1010 **10**11 0000 **10**00 0100 => %EA %B0 %84

![image-20220502031304375](/Users/asst211208/Library/Application Support/typora-user-images/image-20220502031304375.png)





### 왜 요청할 때 % 와 여러가지 문자로 점철이 되어 있는걸까?

[percent encoding](https://en.wikipedia.org/wiki/Percent-encoding) 으로 문자열을 인코딩하기 때문이다.

이는 URI 내부에서 ASCII 문자만을 사용하여 URI 를 만들기 때문에 사용하는 인코딩이다.



URL encoding (percent encoding) 에서는 reserved, unreserved character 들 만을 사용해야 한다.

reserved character 는 어떤 의미를 가진 character 들이고,

unreserved 는 아무 의미를 가지지 않는 character 들이다.

![스크린샷 2022-05-02 오전 3.27.52](/Users/asst211208/Library/Application Support/typora-user-images/스크린샷 2022-05-02 오전 3.27.52.png)



만약 이 문자들에 해당하지 않는다면 반드시 percent encoding 이 되어야 한다.



### Binary data

1994년 RFC 1738 에서 URI 에서 바이너리 데이터를 제공하기 위해선 반드시 8bit 로 쪼개어야 하고, 각 byte 에 percent encoding 이 되어야 한다. 





### 참고

- [한글 인코딩 방식](https://d2.naver.com/helloworld/19187)

- [UTF-8](https://en.wikipedia.org/wiki/UTF-8)
- 

















